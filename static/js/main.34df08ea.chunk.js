(this["webpackJsonpcss-depdency-visualizer"]=this["webpackJsonpcss-depdency-visualizer"]||[]).push([[0],{177:function(e,t,n){e.exports=n(200)},182:function(e,t,n){},198:function(e,t,n){},199:function(e,t,n){},200:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),o=n.n(c),l=(n(182),n(18)),i=n.n(l),u=n(32),s=n(17),d=Object(a.createContext)({}),m=n(43);var v=function(e){var t,n=(100*e.percent).toFixed(2),r=e.color||"black",c={width:"".concat(n,"%"),backgroundColor:r},o={backgroundColor:r},l=null==e.className?"line-item":"line-item ".concat(e.className," ");return a.createElement("div",{className:l,onClick:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,e.id)},onMouseEnter:function(){var t;return null===(t=e.onMouseEnter)||void 0===t?void 0:t.call(e,e.id)},onMouseLeave:function(){var t;return null===(t=e.onMouseLeave)||void 0===t?void 0:t.call(e,e.id)},style:e.style},a.createElement("div",{className:"line-item_color",style:o}),a.createElement("div",{className:"line-item_name"},e.name),a.createElement("div",{className:"line-item_bar"},a.createElement("div",{className:"bar"},a.createElement("div",{className:"bar_fill",style:c}))),a.createElement("div",{className:"line-item_count"},null===(t=e.count)||void 0===t?void 0:t.toLocaleString()),a.createElement("div",{className:"line-item_percentage"},n,"%"))},f=n(9),h=n(14);n(195);var p=function(e){var t=e.node.children.sort((function(e,t){return t.count-e.count})),n=Object(f.f)(),c=Object(f.g)().pathname.substr(1).split("/"),o=Object(a.useContext)(d),l=o.hoverNode,i=o.setHoverNode,u=function(e){i(e)},s=function(e){i(null)},p=Object(h.e)().domain(t.map((function(e){return e.name}))).range(Object(h.d)((function(e){return Object(h.b)(.8*e+.1)}),t.length).reverse()),b=function(e){var a=t[e.index],o=a.id===l?"line-item--hover":void 0,i=p(a.name);return r.a.createElement(v,Object.assign({key:e.key,color:i,className:o,onClick:function(){"HTML"!==a.type&&(""!==c[0]?(console.log(c),n.push("/".concat(c.join("/"),"/").concat(a.id))):n.push(a.id))},onMouseEnter:u,onMouseLeave:s,style:e.style},function(e){var t=e.name,n=e.id,a=e.percent;return{name:t,id:n,count:e.count,percent:a}}(a)))};return r.a.createElement(m.a,null,(function(e){var n=e.width,a=e.height;return r.a.createElement("div",null,r.a.createElement(m.b,{height:a,overscanRowCount:2,rowCount:t.length,rowHeight:41,rowRenderer:b,width:n}))}))};var b=function(e){var t=Object(a.useRef)(null),n=Object(a.useContext)(d),c=n.hoverNode,o=n.setHoverNode,l=Object(f.f)();return Object(a.useEffect)((function(){!function(e,t,n,a){var r=h.e().domain(t.map((function(e){return e.name}))).range(h.d((function(e){return h.b(.8*e+.1)}),t.length).reverse()),c=Math.min(400,400)/2,o=h.a().innerRadius(.57*c).outerRadius(c-1),l=h.f(e).attr("viewBox",[-200,-200,400,400]),i=h.c().padAngle(.005).sort(null).value((function(e){return e.value})),u=i(t),s=i([{value:100}]);l.selectAll("path").data(s).join("path").attr("fill","ghostwhite").attr("stroke","lightgray").attr("d",o),l.selectAll(".arcs").data(u).join("path").classed("arcs",!0).attr("fill",(function(e){return r(e.data.name)})).attr("d",o).on("mouseover",(function(e,t){a(t.data.id)})).on("mouseout",(function(e,t){a(null)})).on("click",(function(e,t){n(t.data.id)}))}(t.current,e.node.children.map((function(e){var t=e.name,n=e.count;return{name:t,id:e.id,value:n}})),(function(e){return l.push(e)}),o)}),[e.node,o,l]),Object(a.useEffect)((function(){!function(e,t){var n=h.f(e).selectAll(".arcs");null!==t?(n.filter((function(e,n){return e.data.id===t})).transition().duration("50").attr("opacity","1"),n.filter((function(e,n){return e.data.id!==t})).transition().duration("50").attr("opacity",".65")):n.transition().duration("50").attr("opacity","1")}(t.current,c)}),[c]),r.a.createElement("svg",{ref:t})},g=n(28);n(198);function E(e,t){return"ARCHIVE"===t.type?e+t.children.filter((function(e){return"HTML"===e.type})).length:"HTML"===t.type?e+1:e}function x(e,t){return"ARCHIVE"===t.type?e+t.children.reduce(x,0):"CSS"===t.type?t.count+e:e}function y(e){var t=e.nodes;if(0===t.length)return null;if("ROOT"!==t[0].type)throw new Error("invariant");if(1===t.length)return r.a.createElement("div",{className:"Stats"},"There are ",r.a.createElement("span",{className:"Stats_primary-metric"},t[0].count.toLocaleString())," CSS files across marxists.org.");if(t.length<2)throw new Error("invariant");for(var n=t[t.length-1],a=t[t.length-2],c=1,o=t[c];"CSS"!==o.type&&c<t.length;)o=t[t.length-c],c++;var l=function(){switch(a.type){case"ARCHIVE":return["of ".concat(o.name,"'s dependents within ").concat(a.name)];case"CSS":return["of ".concat(a.name,"'s dependents across marxists.org")];case"ROOT":var e=n.children.reduce(E,0),t=n.children.reduce(x,0),r="of the css across marxists.org";return t>0?[r,"(".concat(e.toLocaleString()," directly and ").concat(t.toLocaleString()," indirectly)")]:[r];default:throw new Error("invariant")}}(),i=Object(s.a)(l,2),u=i[0],d=i[1],m=(100*n.percent).toFixed(2),v=n.count.toLocaleString(),f=t.slice(1).map((function(e){return e.name})).join(" > "),h=null==d?r.a.createElement(r.a.Fragment,null,"\xa0"):d;return r.a.createElement("div",{className:"Stats"},r.a.createElement("div",{className:"Stats_breadcrumbs"},f),r.a.createElement("div",null,"ARCHIVE"===n.type?"contains":"constitutes"," ",r.a.createElement("span",{className:"Stats_primary-metric"},m,"%")," ","HTML"===n.type?null:"(".concat(v,")")," ",u,r.a.createElement("br",null),h))}var j=function(e){var t=Object(a.useContext)(d),n=t.rootNode,c=t.hoverNode,o=t.store,l=Object(f.g)();if(null==n)return null;var i=function(){var e=l.pathname.substr(1).split("/");return""===e[0]?[]:e}().map((function(e){return o.findById(e)})).filter((function(e){return null!=e})),u=[n].concat(Object(g.a)(i)),s=null===c?null:o.findById(c);return null!=s&&u.push(s),r.a.createElement("div",{className:e.className},r.a.createElement(y,{nodes:u}))};var O=function(e){var t=Object(a.useContext)(d),n=t.rootNode,c=t.store,o=Object(f.g)().pathname.substr(1).split("/"),l=o[o.length-1],i=""===l?n:c.findById(l);return null==i?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"AppTopViz"},r.a.createElement("div",{style:{width:"400px",height:"400px"}},r.a.createElement(b,{node:i}))),r.a.createElement(j,{className:"AppTopStats"}),r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"Header_name"},"Name"),r.a.createElement("div",{className:"Header_bar"}),r.a.createElement("div",{className:"Header_count"},"Count"),r.a.createElement("div",{className:"Header_percentage"},"Percent")),r.a.createElement("div",{className:"AppList"},null==i?null:r.a.createElement(p,{node:i})))};n(199);var N=function(){var e=Object(a.useContext)(d),t=e.setRootNode,n=e.store,c=Object(a.useState)(!0),o=Object(s.a)(c,2),l=o[0],m=o[1];return Object(a.useEffect)((function(){l&&Object(u.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get();case 2:a=e.sent,m(!1),t(a);case 5:case"end":return e.stop()}}),e)})))()})),r.a.createElement("div",{className:"App"},r.a.createElement(f.c,null,l?"loading...":r.a.createElement(f.a,{component:O})))},w=n(16),S=n(89),k=n(90),C=n(42);function H(e){return null==e?null:e[1]}function M(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function R(e,t,n,a){var r=e.total,c=e.nodes,o=t.name,l=o.endsWith(".html")||o.endsWith(".htm")?"HTML":o.endsWith(".css")?"CSS":"ARCHIVE",i=t.children.length>0?t.children.reduce(R,{total:0,nodes:{}}):{total:1,nodes:{}};if(c[o]={children:Object(g.a)(Object.values(i.nodes)),count:i.total,id:M(),name:o,percent:0,type:l},r+=i.total,n===a.length-1){var u=Object.values(c).reduce((function(e,t){var n=t.count/r;return e[t.name]=Object(C.a)(Object(C.a)({},t),{},{percent:n}),e}),{});return{total:r,nodes:u}}return{total:r,nodes:c}}function L(e){return function(e){var t=[e].reduce(R,{total:0,nodes:{}}).nodes[e.name];if(null==t)throw new Error;return t.type="ROOT",console.log(t),t}(function(e){var t=[];t.push(e);for(var n=function(){var e=t.shift();if(null==e)return"break";for(var n=0,a={};n<=e.children.length;)if(n!==e.children.length){var r=e.children[n],c=H(e.name.match(/archive\/([^/]*)\//)),o=H(r.name.match(/archive\/([^/]*)\//));if((r.name.endsWith(".htm")||r.name.endsWith(".html"))&&null!==o&&o!==c){var l="/archive/".concat(o,"/");null==a[l]&&(a[l]=[]),a[l].push(r),e.children.splice(n,1)}else t.push(r),n++}else{var i=Object(g.a)(Object.entries(a));if(0===i.length)break;i.forEach((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];e.children.push({name:a,children:r})})),a={}}};t.length>0;){if("break"===n())break}return e}(e))}var A=function(){function e(){Object(S.a)(this,e),this.data=null,this.nodesById={}}return Object(k.a)(e,[{key:"get",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.data){e.next=2;break}return e.abrupt("return",this.data);case 2:return e.prev=2,e.next=5,fetch("formatted.json");case 5:return e.next=7,e.sent.json();case 7:return t=e.sent,this.data=L(t),this.index(),e.abrupt("return",this.data);case 13:throw e.prev=13,e.t0=e.catch(2),console.error(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"index",value:function(){if(null!=this.data)for(var e=[this.data];e.length>0;){var t=e.shift();if(null==t)break;this.nodesById[t.id]=t;var n,a=Object(w.a)(t.children);try{for(a.s();!(n=a.n()).done;){var r=n.value;e.push(r)}}catch(c){a.e(c)}finally{a.f()}}}},{key:"findById",value:function(e){return this.nodesById[e]}}]),e}(),I=a.useState,_=new A;var T=function(e){var t=I(null),n=Object(s.a)(t,2),r=n[0],c=n[1],o=I(null),l=Object(s.a)(o,2),i=l[0],u=l[1],m=I(null),v=Object(s.a)(m,2),f={rootNode:i,setRootNode:u,selectedNode:r,setSelectedNode:c,hoverNode:v[0],setHoverNode:v[1],store:_};return a.createElement(d.Provider,{value:f},e.children)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=n(26);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null,r.a.createElement(B.a,null,r.a.createElement(N,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[177,1,2]]]);
//# sourceMappingURL=main.34df08ea.chunk.js.map